#' plotting genome feature and synteny maps
#'
#' @param data contig_layout generated by layout_genomes
#' @param ... passed through to geom_contig
#' @importFrom ggplot2 ggplot
#' @export
#' @return ggplot object
gggenomes <- function(data = NULL, ...){
    envir <- parent.frame()
               
    p <- ggplot(data = contig_layout, environment = envir)
    class(p) <- c('gggenomes', class(p))
    p + theme_genomes() +
        scale_y_genomes(contig_layout)
}

#' gggenomes default theme
#' @importFrom ggplot2 theme_bw
#' @importFrom ggplot2 theme
#' @export
#' @return ggplot theme
theme_genomes <- function(){
    theme_bw() + theme(
        panel.border = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "white"),
        axis.title.x=element_blank(),
        axis.title.y=element_blank(),
        axis.ticks.y=element_blank())
}

#' y scale with genome labels
#' 
#' @import ggplot2
#' @export
#' @return ggplot scale object
scale_y_genomes <- function(contig_layout){
    scale_y_reverse(breaks=unique(contig_layout$gix), labels=unique(contig_layout$gid))
}
